{"version":3,"file":"OEView.js","sourceRoot":"","sources":["../../../../../Volumes/Data/OElite/cosmos/public/OEme/tmp/broccoli_type_script_compiler-input_base_path-7nMsUUjz.tmp/0/src/app/core/framework/ui/view/OEView.ts"],"names":[],"mappings":"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","sourcesContent":["import {Component, Output} from \"@angular/core\";\nimport {OELayoutConfig, LayoutSection} from \"../../layout/OELayoutConfig\";\nimport {Utils} from \"../../../utils/funcs\";\nimport {OEAppState} from \"../../OEAppState\";\nimport {Router} from \"@angular/router\";\nimport {IOERoute} from \"../../IOEModule\";\nimport {OEUIState} from \"../../layout/OEUIState\";\n\n/**\n * Created by mleader1 on 28/06/2016.\n */\nexport interface IOEView {\n    appState:OEAppState;\n}\n\n@Component({\n    selector: OEView.viewSelector,\n    template: '<ng-content select=\"oeview-enforced\"></ng-content>'\n})\n\n\nexport class OEView implements IOEView {\n    public static viewSelector:string = 'oeView-' + Utils.NewGuid().toString();\n\n    constructor(public appState:OEAppState, public router:Router, public viewId:string) {\n\n    }\n\n    public isViewable(viewDefinition:OELayoutConfig):boolean {\n        return viewDefinition && viewDefinition.isViewable();\n    }\n\n    ngOnInit() {\n        this.initMainView();\n    }\n\n\n    /**\n     * init a main view based on the route hitting the current page\n     */\n    private initMainView(triggeredByRoute?:IOERoute) {\n        var mainViewLocal = null;\n        // if (mainViewLocal)\n        //     return;\n\n        if (this.appState.routeState) {\n            var existingOERoute:IOERoute = triggeredByRoute || this.appState.routeState.findRouteByPath(document.location.pathname);\n\n            if (!existingOERoute || !existingOERoute.page) {\n                //give another try using wild card\n                /**\n                 ** validate   pathSec1/**,  pathSec1/pathSec2/**, ....  ,path/**  and **\n                 */\n                var segments = document.location.pathname.split('/');\n                if (segments && segments.length > 0) {\n                    var segmentGrowth = '';\n                    //lowest priority check\n                    existingOERoute = this.appState.routeState.findRouteByPath('**');\n                    for (var seg of segments) {\n                        segmentGrowth = segmentGrowth == '' ? seg : segmentGrowth + '/' + seg;\n                        var higherPriorityCheck = this.appState.routeState.findRouteByPath(segmentGrowth + '/**');\n                        if (higherPriorityCheck && higherPriorityCheck.page)\n                            existingOERoute = higherPriorityCheck;\n                    }\n                }\n\n            }\n            if (existingOERoute) {\n                mainViewLocal = new OELayoutConfig(existingOERoute.viewSelector, [existingOERoute.page], new OEUIState(true, false, false, null), LayoutSection.Main);\n            }\n        }\n        if (mainViewLocal)\n            this.appState.layoutState.setState(mainViewLocal, this.viewId);\n        else\n            this.appState.layoutState.setState(new OELayoutConfig(null, [], new OEUIState(true, false, false, null), LayoutSection.Main), this.viewId);\n\n    }\n}"]}